let express,data,binSearch,categories;_ee1‍.x([["default",()=>_ee1‍.o]]);_ee1‍.w("express",[["default",["express"],function(v){express=v}]]);_ee1‍.w("../../data.js",[["default",["data"],function(v){data=v}]]);_ee1‍.w("../bin-search.js",[["default",["binSearch"],function(v){binSearch=v}]]);_ee1‍.w("../../categories.js",[["default",["categories"],function(v){categories=v}]]);





const gpRouter = express.Router();

//grocery by id
gpRouter.get('/groceries/id/:id', (req, res)=>{              
    let id = parseInt(req.params.id); 
    if (isNaN(id)){
        res.status(404).json({message: `Invalid id`});
    }
    else{
    let response= data.find((grocery) => grocery.id === id.toString());
    if (!response){
        res.status(404).json({message: `Grocery with ID: ${id} does not exist`});
    }
    res.json(response).status(200)
}
});

//grocery by name
gpRouter.get('/groceries/name/:name', (req, res)=> {
    let name = req.params.name;

    // Make sure the name has the potential to be valid before conducting search
    // Check if the first letter of each word is capitalized:
    let words = name.split(' ');
    for (let j = 0; j < words.length; ++j) {
        if (words[j][0] < 'A' || words[j][0] > 'Z') {
            return res.status(400).json({ error: "All words in the grocery must start with a capital letter." });
        }
    }

    let response = binSearch(data, name);
    if (!response){
        res.status(404).json({message: `Grocery with name: ${name} does not exist`});
    }
    res.json(response).status(200)
});

//grocery by category
gpRouter.get('/groceries/category/:category', (req, res)=>{
    let category = req.params.category;

    // Make sure category is a valid category
    let isValid = false;
    categories.forEach(cat => {
        if (category === cat) {
            isValid = true;
        }
    });
    
    if (!isValid) {
        return res.status(400).json({ error: `Provided category: ${category} is invalid` });
    }

    let response = data.filter((grocery) => grocery.category === category);
    if (!response){
        res.status(404).json({message: `Grocery category: ${category} does not exist`});
    }
    res.json(response).status(200)
});


_ee1‍.d(gpRouter);
